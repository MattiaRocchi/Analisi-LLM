responses:
  - id: Q1
    query: |
      SELECT * FROM cypher('agri_graph', $$
        MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})<-[r:belongsTo]-(p:AgriParcel)
        RETURN f, r, p
      $$) as (f agtype, r agtype, p agtype);
  - id: Q2
    query: |
      SELECT * FROM cypher('agri_graph', $$
        MATCH (p:AgriParcel {name: 'Fondo Errano 2024 T0'})<-[r:belongsTo]-(d:Device)
        RETURN p, r, d
      $$) as (p agtype, r agtype, d agtype);
  - id: Q3
    query: |
      SELECT * FROM cypher('agri_graph', $$
        MATCH (d:Device)
        WHERE 'soilMoisture' IN d.controlledProperty
        MATCH (d)-[r]-(n)
        RETURN d, r, n
      $$) as (d agtype, r agtype, n agtype);
  - id: Q4
    query: |
      SELECT * FROM cypher('agri_graph', $$
        MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})<-[r1:belongsTo]-(p:AgriParcel)<-[r2:belongsTo]-(d:Device)
        WHERE 'soilMoisture' IN d.controlledProperty
        RETURN f, r1, p, r2, d
      $$) as (f agtype, r1 agtype, p agtype, r2 agtype, d agtype);
  - id: Q5
    query: |
      SELECT * FROM cypher('agri_graph', $$
        MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})<-[r:belongsTo]-(p:AgriParcel)
        WHERE p.colture CONTAINS 'Kiwi'
        RETURN f, r, p
      $$) as (f agtype, r agtype, p agtype);
  - id: Q6
    query: |
      SELECT * FROM cypher('agri_graph', $$
        MATCH (p:AgriParcel {name: 'T1'})<-[r:belongsTo]-(d:Device)
        WHERE 'dripper' IN d.controlledProperty
        RETURN p, r, d
      $$) as (p agtype, r agtype, d agtype);
  - id: Q7
    query: |
      SELECT g.v, g.e, g.v2
      FROM cypher('agri_graph', $$
          MATCH (d:Device)-[r]-(n)
          WHERE 'soilMoisture' IN d.controlledProperty
          RETURN d.id as device_id, d, r, n
      $$) as g(device_id agtype, v agtype, e agtype, v2 agtype)
      JOIN public.measurements m ON trim(g.device_id::text, '"') = m.device_id
      WHERE m.controlled_property = 'soilMoisture'
      ORDER BY m.value ASC
      LIMIT 1;
  - id: Q8
    query: |
      SELECT g.v, g.e, g.v2
      FROM cypher('agri_graph', $$
          MATCH (d:Device)-[r]-(n)
          WHERE 'sensor' IN d.deviceCategory AND d.location IS NOT NULL
          RETURN d, r, n, d.location as loc
      $$) as g(v agtype, e agtype, v2 agtype, location agtype)
      ORDER BY trim(g.location::text, '"')::geometry <-> 'POINT (11.799 44.235)'::geometry
      LIMIT 1;
  - id: Q9
    query: |
      SELECT * FROM cypher('agri_graph', $$
        MATCH (p:AgriParcel)<-[r:belongsTo]-(d:Device)
        WITH p, count(d) as deviceCount
        ORDER BY deviceCount DESC
        LIMIT 1
        MATCH (p)-[r2]-(n)
        RETURN p, r2, n
      $$) as (p agtype, r2 agtype, n agtype);
  - id: Q10
    query: |
      SELECT g.v, g.e, g.v2
      FROM cypher('agri_graph', $$
          MATCH (d:Device)-[r]-(n)
          WHERE 'temperature' IN d.controlledProperty
          RETURN d.id as device_id, d, r, n
      $$) as g(device_id agtype, v agtype, e agtype, v2 agtype)
      JOIN public.measurements m ON trim(g.device_id::text, '"') = m.device_id
      WHERE m.controlled_property = 'temperature'
      ORDER BY m.value ASC
      LIMIT 1;