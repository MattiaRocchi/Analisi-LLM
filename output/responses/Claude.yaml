responses:
  - id: Q1
    query: |
      SELECT count(*) 
      FROM cypher('agri_graph', $$
        MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})<-[:belongsTo]-(p:AgriParcel)
        RETURN count(p) as parcel_count
      $$) as (parcel_count agtype);

  - id: Q2
    query: |
      SELECT *
      FROM cypher('agri_graph', $$
        MATCH (p:AgriParcel {name: 'Fondo Errano 2024 T0'})<-[:belongsTo]-(d:Device)
        RETURN d.id as device_id
      $$) as (device_id agtype);

  - id: Q3
    query: |
      SELECT *
      FROM cypher('agri_graph', $$
        MATCH (d:Device)
        WHERE 'soilMoisture' IN d.controlledProperty
        RETURN d.id as device_id
      $$) as (device_id agtype);

  - id: Q4
    query: |
      SELECT *
      FROM cypher('agri_graph', $$
        MATCH (f:AgriFarm)-[*]->(d:Device)
        WHERE 'soilMoisture' IN d.controlledProperty
        RETURN d.id as device_id
      $$) as (device_id agtype);

  - id: Q5
    query: |
      SELECT *
      FROM cypher('agri_graph', $$
        MATCH (f:AgriFarm)<-[:belongsTo]-(p:AgriParcel)
        WHERE p.colture CONTAINS 'Kiwi'
        RETURN p.id as parcel_id, p.colture as culture
      $$) as (parcel_id agtype, culture agtype);

  - id: Q6
    query: |
      SELECT *
      FROM cypher('agri_graph', $$
        MATCH (p:AgriParcel {name: 'Fondo Errano 2024 T1'})<-[:belongsTo]-(d:Device)
        WHERE 'dripper' IN d.controlledProperty
        RETURN d.id as device_id
      $$) as (device_id agtype);

  - id: Q7
    query: |
      SELECT device_id, min_value
      FROM (
        SELECT device_id, controlled_property, MIN(value) as min_value
        FROM public.measurements
        WHERE controlled_property = 'soilMoisture'
        GROUP BY device_id, controlled_property
        ORDER BY min_value ASC
        LIMIT 1
      ) subquery;

  - id: Q8
    query: |
      SELECT *
      FROM cypher('agri_graph', $$
        MATCH (d:Device)
        WHERE d.location IS NOT NULL
        WITH d, point({longitude: 11.799, latitude: 44.235}) as target_point,
             point({longitude: toFloat(split(replace(replace(d.location, 'POINT (', ''), ')', ''), ' ')[0]), 
                    latitude: toFloat(split(replace(replace(d.location, 'POINT (', ''), ')', ''), ' ')[1])}) as device_point
        RETURN d.id as device_id, d.location as location, 
               distance(target_point, device_point) as distance_meters
        ORDER BY distance_meters ASC
        LIMIT 1
      $$) as (device_id agtype, location agtype, distance_meters agtype);

  - id: Q9
    query: |
      SELECT *
      FROM cypher('agri_graph', $$
        MATCH (p:AgriParcel)<-[:belongsTo]-(d:Device)
        WITH p, count(d) as device_count
        RETURN p.id as parcel_id, device_count
        ORDER BY device_count DESC
        LIMIT 1
      $$) as (parcel_id agtype, device_count agtype);

  - id: Q10
    query: |
      SELECT m.device_id, m.value as min_temperature
      FROM public.measurements m
      WHERE m.controlled_property = 'temperature'
      ORDER BY m.value ASC
      LIMIT 1;