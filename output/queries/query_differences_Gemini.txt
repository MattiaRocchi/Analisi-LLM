================================================================================
QUERY COMPARISON REPORT
Generated: 2025-10-28 09:21:43
Ground Truth File: ../../prompts/queries/responses_groundTrue.yaml
LLM Output File: ../../output/responses/Gemini.yaml
================================================================================

================================================================================
DIFFERENCE FOUND - Query ID: Q1
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT COUNT(*) AS num_parcels FROM cypher('agri_graph', $$
  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
  RETURN COUNT(parcel) AS num_parcels
$$) AS (num_parcels agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (m:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(n:AgriParcel)
RETURN count(n)

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,4 +1,2 @@
-SELECT COUNT(*) AS num_parcels FROM cypher('agri_graph', $$
-  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
-  RETURN COUNT(parcel) AS num_parcels
-$$) AS (num_parcels agtype);
+MATCH (m:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(n:AgriParcel)
+RETURN count(n)


================================================================================
DIFFERENCE FOUND - Query ID: Q2
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id FROM cypher('agri_graph', $$
  MATCH (parcel:AgriParcel {name: 'Fondo Errano 2024 T0'})-[:hasDevice]->(device:Device)
  RETURN device.id AS device_id
$$) AS (device_id agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (n:AgriParcel {name: 'Fondo Errano 2024 T0'})-[:hasDevice]->(d:Device)
RETURN d.id

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,4 +1,2 @@
-SELECT device_id FROM cypher('agri_graph', $$
-  MATCH (parcel:AgriParcel {name: 'Fondo Errano 2024 T0'})-[:hasDevice]->(device:Device)
-  RETURN device.id AS device_id
-$$) AS (device_id agtype);
+MATCH (n:AgriParcel {name: 'Fondo Errano 2024 T0'})-[:hasDevice]->(d:Device)
+RETURN d.id


================================================================================
DIFFERENCE FOUND - Query ID: Q3
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name FROM cypher('agri_graph', $$
  MATCH (device:Device)
  WHERE device.name CONTAINS 'Ges v' OR device.name CONTAINS 'Soil moisture'
  RETURN device.id AS device_id, device.name AS device_name
$$) AS (device_id agtype, device_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (n:Device)
WHERE 'soilMoisture' IN n.controlledProperty
RETURN DISTINCT n.name

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,5 +1,3 @@
-SELECT device_id, device_name FROM cypher('agri_graph', $$
-  MATCH (device:Device)
-  WHERE device.name CONTAINS 'Ges v' OR device.name CONTAINS 'Soil moisture'
-  RETURN device.id AS device_id, device.name AS device_name
-$$) AS (device_id agtype, device_name agtype);
+MATCH (n:Device)
+WHERE 'soilMoisture' IN n.controlledProperty
+RETURN DISTINCT n.name


================================================================================
DIFFERENCE FOUND - Query ID: Q4
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name, parcel_name FROM cypher('agri_graph', $$
  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)-[:hasDevice]->(sensor:Device)
  WHERE sensor.name CONTAINS 'Ges v' OR sensor.name CONTAINS 'Soil moisture'
  RETURN sensor.id AS device_id, sensor.name AS device_name, parcel.name AS parcel_name
$$) AS (device_id agtype, device_name agtype, parcel_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (m:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice*]->(n:Device)
WHERE 'soilMoisture' IN n.controlledProperty
RETURN DISTINCT n.name

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,5 +1,3 @@
-SELECT device_id, device_name, parcel_name FROM cypher('agri_graph', $$
-  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)-[:hasDevice]->(sensor:Device)
-  WHERE sensor.name CONTAINS 'Ges v' OR sensor.name CONTAINS 'Soil moisture'
-  RETURN sensor.id AS device_id, sensor.name AS device_name, parcel.name AS parcel_name
-$$) AS (device_id agtype, device_name agtype, parcel_name agtype);
+MATCH (m:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice*]->(n:Device)
+WHERE 'soilMoisture' IN n.controlledProperty
+RETURN DISTINCT n.name


================================================================================
DIFFERENCE FOUND - Query ID: Q5
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT parcel_name FROM cypher('agri_graph', $$
  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
  RETURN parcel.name AS parcel_name
$$) AS (parcel_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (m:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(n:AgriParcel)
WHERE n.colture = 'Kiwi G3'
RETURN n.name

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,4 +1,3 @@
-SELECT parcel_name FROM cypher('agri_graph', $$
-  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
-  RETURN parcel.name AS parcel_name
-$$) AS (parcel_name agtype);
+MATCH (m:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(n:AgriParcel)
+WHERE n.colture = 'Kiwi G3'
+RETURN n.name


================================================================================
DIFFERENCE FOUND - Query ID: Q6
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name FROM cypher('agri_graph', $$
  MATCH (parcel:AgriParcel {name: 'Fondo Errano 2024 T1'})-[:hasDevice]->(device:Device)
  WHERE device.name CONTAINS 'Dripper'
  RETURN device.id AS device_id, device.name AS device_name
$$) AS (device_id agtype, device_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (n:AgriParcel {name: 'Fondo Errano 2024 T1'})-[:hasDevice]->(d:Device)
WHERE 'dripper' IN d.controlledProperty
RETURN d.name

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,5 +1,3 @@
-SELECT device_id, device_name FROM cypher('agri_graph', $$
-  MATCH (parcel:AgriParcel {name: 'Fondo Errano 2024 T1'})-[:hasDevice]->(device:Device)
-  WHERE device.name CONTAINS 'Dripper'
-  RETURN device.id AS device_id, device.name AS device_name
-$$) AS (device_id agtype, device_name agtype);
+MATCH (n:AgriParcel {name: 'Fondo Errano 2024 T1'})-[:hasDevice]->(d:Device)
+WHERE 'dripper' IN d.controlledProperty
+RETURN d.name


================================================================================
DIFFERENCE FOUND - Query ID: Q7
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name FROM cypher('agri_graph', $$
  MATCH (sensor:Device)
  WHERE sensor.name CONTAINS 'Ges v' OR sensor.name CONTAINS 'Soil moisture'
  RETURN sensor.id AS device_id, sensor.name AS device_name
  LIMIT 1
$$) AS (device_id agtype, device_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (n:Device)
WHERE EXISTS(n.value) AND 'soilMoisture' IN n.controlledProperty
UNWIND n.value AS val
RETURN n.name, val
ORDER BY val
LIMIT 1

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,6 +1,6 @@
-SELECT device_id, device_name FROM cypher('agri_graph', $$
-  MATCH (sensor:Device)
-  WHERE sensor.name CONTAINS 'Ges v' OR sensor.name CONTAINS 'Soil moisture'
-  RETURN sensor.id AS device_id, sensor.name AS device_name
-  LIMIT 1
-$$) AS (device_id agtype, device_name agtype);
+MATCH (n:Device)
+WHERE EXISTS(n.value) AND 'soilMoisture' IN n.controlledProperty
+UNWIND n.value AS val
+RETURN n.name, val
+ORDER BY val
+LIMIT 1


================================================================================
DIFFERENCE FOUND - Query ID: Q8
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name, location FROM cypher('agri_graph', $$
  MATCH (device:Device)
  WHERE device.location IS NOT NULL
  WITH device, 
       split(split(device.location, '(')[1], ' ')[0] AS lon_str,
       split(split(split(device.location, '(')[1], ' ')[1], ')')[0] AS lat_str
  WITH device, 
       toFloat(lon_str) AS lon, 
       toFloat(lat_str) AS lat,
       sqrt((lon - 11.799)^2 + (lat - 44.235)^2) AS distance
  RETURN device.id AS device_id, device.name AS device_name, device.location AS location
  ORDER BY distance ASC 
  LIMIT 1
$$) AS (device_id agtype, device_name agtype, location agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (n:Device)
WHERE EXISTS(n.location)
WITH n, point({latitude: 44.235, longitude: 11.799}) AS target_point
RETURN n.name, point(n.location) AS sensor_point
ORDER BY distance(sensor_point, target_point)
LIMIT 1

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,14 +1,6 @@
-SELECT device_id, device_name, location FROM cypher('agri_graph', $$
-  MATCH (device:Device)
-  WHERE device.location IS NOT NULL
-  WITH device, 
-       split(split(device.location, '(')[1], ' ')[0] AS lon_str,
-       split(split(split(device.location, '(')[1], ' ')[1], ')')[0] AS lat_str
-  WITH device, 
-       toFloat(lon_str) AS lon, 
-       toFloat(lat_str) AS lat,
-       sqrt((lon - 11.799)^2 + (lat - 44.235)^2) AS distance
-  RETURN device.id AS device_id, device.name AS device_name, device.location AS location
-  ORDER BY distance ASC 
-  LIMIT 1
-$$) AS (device_id agtype, device_name agtype, location agtype);
+MATCH (n:Device)
+WHERE EXISTS(n.location)
+WITH n, point({latitude: 44.235, longitude: 11.799}) AS target_point
+RETURN n.name, point(n.location) AS sensor_point
+ORDER BY distance(sensor_point, target_point)
+LIMIT 1


================================================================================
DIFFERENCE FOUND - Query ID: Q9
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT parcel_name, device_count
FROM cypher('agri_graph', $$
  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
  OPTIONAL MATCH (parcel)-[:hasDevice]->(device:Device)
  WITH parcel, COUNT(device) AS device_count
  RETURN parcel.name AS parcel_name, device_count
  ORDER BY device_count DESC 
  LIMIT 1
$$) AS (parcel_name agtype, device_count agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
MATCH (a:AgriParcel)-[:hasDevice]->(d1:Device)
OPTIONAL MATCH (d1)-[:hasDevice]->(d2:Device)
WITH a, count(d1) + count(d2) AS total_devices
RETURN a.name, total_devices
ORDER BY total_devices DESC
LIMIT 1

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,9 +1,6 @@
-SELECT parcel_name, device_count
-FROM cypher('agri_graph', $$
-  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
-  OPTIONAL MATCH (parcel)-[:hasDevice]->(device:Device)
-  WITH parcel, COUNT(device) AS device_count
-  RETURN parcel.name AS parcel_name, device_count
-  ORDER BY device_count DESC 
-  LIMIT 1
-$$) AS (parcel_name agtype, device_count agtype);
+MATCH (a:AgriParcel)-[:hasDevice]->(d1:Device)
+OPTIONAL MATCH (d1)-[:hasDevice]->(d2:Device)
+WITH a, count(d1) + count(d2) AS total_devices
+RETURN a.name, total_devices
+ORDER BY total_devices DESC
+LIMIT 1


================================================================================
SUMMARY
================================================================================
Total queries compared: 9
Queries in ground truth: 9
Queries in LLM output: 9

Differences detected - see details above
