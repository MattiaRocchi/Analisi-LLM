================================================================================
QUERY COMPARISON REPORT
Generated: 2025-10-28 09:20:12
Ground Truth File: ../../prompts/queries/responses_groundTrue.yaml
LLM Output File: ../../output/responses/DeepSeek.yaml
================================================================================

================================================================================
DIFFERENCE FOUND - Query ID: Q1
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT COUNT(*) AS num_parcels FROM cypher('agri_graph', $$
  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
  RETURN COUNT(parcel) AS num_parcels
$$) AS (num_parcels agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT COUNT(*) as count
FROM cypher('agri_graph', $$
  MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(p:AgriParcel)
  RETURN COUNT(p)
$$) as (count agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,4 +1,5 @@
-SELECT COUNT(*) AS num_parcels FROM cypher('agri_graph', $$
-  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
-  RETURN COUNT(parcel) AS num_parcels
-$$) AS (num_parcels agtype);
+SELECT COUNT(*) as count
+FROM cypher('agri_graph', $$
+  MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(p:AgriParcel)
+  RETURN COUNT(p)
+$$) as (count agtype);


================================================================================
DIFFERENCE FOUND - Query ID: Q2
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id FROM cypher('agri_graph', $$
  MATCH (parcel:AgriParcel {name: 'Fondo Errano 2024 T0'})-[:hasDevice]->(device:Device)
  RETURN device.id AS device_id
$$) AS (device_id agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT d.id
FROM cypher('agri_graph', $$
  MATCH (p:AgriParcel {name: 'Fondo Errano 2024 T0'})-[:hasDevice]->(d:Device)
  RETURN d.id
$$) as (id agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,4 +1,5 @@
-SELECT device_id FROM cypher('agri_graph', $$
-  MATCH (parcel:AgriParcel {name: 'Fondo Errano 2024 T0'})-[:hasDevice]->(device:Device)
-  RETURN device.id AS device_id
-$$) AS (device_id agtype);
+SELECT d.id
+FROM cypher('agri_graph', $$
+  MATCH (p:AgriParcel {name: 'Fondo Errano 2024 T0'})-[:hasDevice]->(d:Device)
+  RETURN d.id
+$$) as (id agtype);


================================================================================
DIFFERENCE FOUND - Query ID: Q3
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name FROM cypher('agri_graph', $$
  MATCH (device:Device)
  WHERE device.name CONTAINS 'Ges v' OR device.name CONTAINS 'Soil moisture'
  RETURN device.id AS device_id, device.name AS device_name
$$) AS (device_id agtype, device_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT d.id
FROM cypher('agri_graph', $$
  MATCH (d:Device)
  WHERE 'soilMoisture' IN d.controlledProperty
  RETURN d.id
$$) as (id agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,5 +1,6 @@
-SELECT device_id, device_name FROM cypher('agri_graph', $$
-  MATCH (device:Device)
-  WHERE device.name CONTAINS 'Ges v' OR device.name CONTAINS 'Soil moisture'
-  RETURN device.id AS device_id, device.name AS device_name
-$$) AS (device_id agtype, device_name agtype);
+SELECT d.id
+FROM cypher('agri_graph', $$
+  MATCH (d:Device)
+  WHERE 'soilMoisture' IN d.controlledProperty
+  RETURN d.id
+$$) as (id agtype);


================================================================================
DIFFERENCE FOUND - Query ID: Q4
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name, parcel_name FROM cypher('agri_graph', $$
  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)-[:hasDevice]->(sensor:Device)
  WHERE sensor.name CONTAINS 'Ges v' OR sensor.name CONTAINS 'Soil moisture'
  RETURN sensor.id AS device_id, sensor.name AS device_name, parcel.name AS parcel_name
$$) AS (device_id agtype, device_name agtype, parcel_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT d.id
FROM cypher('agri_graph', $$
  MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(p:AgriParcel)-[:hasDevice*..2]->(d:Device)
  WHERE 'soilMoisture' IN d.controlledProperty
  RETURN DISTINCT d.id
$$) as (id agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,5 +1,6 @@
-SELECT device_id, device_name, parcel_name FROM cypher('agri_graph', $$
-  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)-[:hasDevice]->(sensor:Device)
-  WHERE sensor.name CONTAINS 'Ges v' OR sensor.name CONTAINS 'Soil moisture'
-  RETURN sensor.id AS device_id, sensor.name AS device_name, parcel.name AS parcel_name
-$$) AS (device_id agtype, device_name agtype, parcel_name agtype);
+SELECT d.id
+FROM cypher('agri_graph', $$
+  MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(p:AgriParcel)-[:hasDevice*..2]->(d:Device)
+  WHERE 'soilMoisture' IN d.controlledProperty
+  RETURN DISTINCT d.id
+$$) as (id agtype);


================================================================================
DIFFERENCE FOUND - Query ID: Q5
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT parcel_name FROM cypher('agri_graph', $$
  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
  RETURN parcel.name AS parcel_name
$$) AS (parcel_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT p.name
FROM cypher('agri_graph', $$
  MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(p:AgriParcel)
  WHERE p.colture CONTAINS 'Kiwi'
  RETURN p.name
$$) as (name agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,4 +1,6 @@
-SELECT parcel_name FROM cypher('agri_graph', $$
-  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
-  RETURN parcel.name AS parcel_name
-$$) AS (parcel_name agtype);
+SELECT p.name
+FROM cypher('agri_graph', $$
+  MATCH (f:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(p:AgriParcel)
+  WHERE p.colture CONTAINS 'Kiwi'
+  RETURN p.name
+$$) as (name agtype);


================================================================================
DIFFERENCE FOUND - Query ID: Q6
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name FROM cypher('agri_graph', $$
  MATCH (parcel:AgriParcel {name: 'Fondo Errano 2024 T1'})-[:hasDevice]->(device:Device)
  WHERE device.name CONTAINS 'Dripper'
  RETURN device.id AS device_id, device.name AS device_name
$$) AS (device_id agtype, device_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT d.id
FROM cypher('agri_graph', $$
  MATCH (p:AgriParcel {name: 'Fondo Errano 2024 T1'})-[:hasDevice]->(d:Device)
  WHERE 'dripper' IN d.controlledProperty
  RETURN d.id
$$) as (id agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,5 +1,6 @@
-SELECT device_id, device_name FROM cypher('agri_graph', $$
-  MATCH (parcel:AgriParcel {name: 'Fondo Errano 2024 T1'})-[:hasDevice]->(device:Device)
-  WHERE device.name CONTAINS 'Dripper'
-  RETURN device.id AS device_id, device.name AS device_name
-$$) AS (device_id agtype, device_name agtype);
+SELECT d.id
+FROM cypher('agri_graph', $$
+  MATCH (p:AgriParcel {name: 'Fondo Errano 2024 T1'})-[:hasDevice]->(d:Device)
+  WHERE 'dripper' IN d.controlledProperty
+  RETURN d.id
+$$) as (id agtype);


================================================================================
DIFFERENCE FOUND - Query ID: Q7
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name FROM cypher('agri_graph', $$
  MATCH (sensor:Device)
  WHERE sensor.name CONTAINS 'Ges v' OR sensor.name CONTAINS 'Soil moisture'
  RETURN sensor.id AS device_id, sensor.name AS device_name
  LIMIT 1
$$) AS (device_id agtype, device_name agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT d.id, d.value[0] as lowest_value
FROM cypher('agri_graph', $$
  MATCH (d:Device)
  WHERE 'soilMoisture' IN d.controlledProperty AND d.value IS NOT NULL
  RETURN d.id, d.value[0]
  ORDER BY d.value[0] ASC
  LIMIT 1
$$) as (id agtype, lowest_value agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,6 +1,8 @@
-SELECT device_id, device_name FROM cypher('agri_graph', $$
-  MATCH (sensor:Device)
-  WHERE sensor.name CONTAINS 'Ges v' OR sensor.name CONTAINS 'Soil moisture'
-  RETURN sensor.id AS device_id, sensor.name AS device_name
+SELECT d.id, d.value[0] as lowest_value
+FROM cypher('agri_graph', $$
+  MATCH (d:Device)
+  WHERE 'soilMoisture' IN d.controlledProperty AND d.value IS NOT NULL
+  RETURN d.id, d.value[0]
+  ORDER BY d.value[0] ASC
   LIMIT 1
-$$) AS (device_id agtype, device_name agtype);
+$$) as (id agtype, lowest_value agtype);


================================================================================
DIFFERENCE FOUND - Query ID: Q8
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT device_id, device_name, location FROM cypher('agri_graph', $$
  MATCH (device:Device)
  WHERE device.location IS NOT NULL
  WITH device, 
       split(split(device.location, '(')[1], ' ')[0] AS lon_str,
       split(split(split(device.location, '(')[1], ' ')[1], ')')[0] AS lat_str
  WITH device, 
       toFloat(lon_str) AS lon, 
       toFloat(lat_str) AS lat,
       sqrt((lon - 11.799)^2 + (lat - 44.235)^2) AS distance
  RETURN device.id AS device_id, device.name AS device_name, device.location AS location
  ORDER BY distance ASC 
  LIMIT 1
$$) AS (device_id agtype, device_name agtype, location agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT d.id
FROM cypher('agri_graph', $$
  MATCH (d:Device)
  WHERE d.location IS NOT NULL
  RETURN d.id
  ORDER BY ST_Distance(
    ST_GeomFromText(d.location),
    ST_GeomFromText('POINT(11.799 44.235)')
  ) ASC
  LIMIT 1
$$) as (id agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,14 +1,11 @@
-SELECT device_id, device_name, location FROM cypher('agri_graph', $$
-  MATCH (device:Device)
-  WHERE device.location IS NOT NULL
-  WITH device, 
-       split(split(device.location, '(')[1], ' ')[0] AS lon_str,
-       split(split(split(device.location, '(')[1], ' ')[1], ')')[0] AS lat_str
-  WITH device, 
-       toFloat(lon_str) AS lon, 
-       toFloat(lat_str) AS lat,
-       sqrt((lon - 11.799)^2 + (lat - 44.235)^2) AS distance
-  RETURN device.id AS device_id, device.name AS device_name, device.location AS location
-  ORDER BY distance ASC 
+SELECT d.id
+FROM cypher('agri_graph', $$
+  MATCH (d:Device)
+  WHERE d.location IS NOT NULL
+  RETURN d.id
+  ORDER BY ST_Distance(
+    ST_GeomFromText(d.location),
+    ST_GeomFromText('POINT(11.799 44.235)')
+  ) ASC
   LIMIT 1
-$$) AS (device_id agtype, device_name agtype, location agtype);
+$$) as (id agtype);


================================================================================
DIFFERENCE FOUND - Query ID: Q9
================================================================================

GROUND TRUTH QUERY:
--------------------------------------------------------------------------------
SELECT parcel_name, device_count
FROM cypher('agri_graph', $$
  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
  OPTIONAL MATCH (parcel)-[:hasDevice]->(device:Device)
  WITH parcel, COUNT(device) AS device_count
  RETURN parcel.name AS parcel_name, device_count
  ORDER BY device_count DESC 
  LIMIT 1
$$) AS (parcel_name agtype, device_count agtype);

LLM GENERATED QUERY:
--------------------------------------------------------------------------------
SELECT p.name, device_count
FROM cypher('agri_graph', $$
  MATCH (p:AgriParcel)-[:hasDevice]->(d:Device)
  RETURN p.name, COUNT(d) as device_count
  ORDER BY device_count DESC
  LIMIT 1
$$) as (name agtype, device_count agtype);

DETAILED DIFF:
--------------------------------------------------------------------------------
--- Ground Truth
+++ LLM Output
@@ -1,9 +1,7 @@
-SELECT parcel_name, device_count
+SELECT p.name, device_count
 FROM cypher('agri_graph', $$
-  MATCH (farm:AgriFarm {name: 'ZESPRI AZ. AGR. DALLE FABBRICHE ANDREA'})-[:hasDevice]->(parcel:AgriParcel)
-  OPTIONAL MATCH (parcel)-[:hasDevice]->(device:Device)
-  WITH parcel, COUNT(device) AS device_count
-  RETURN parcel.name AS parcel_name, device_count
-  ORDER BY device_count DESC 
+  MATCH (p:AgriParcel)-[:hasDevice]->(d:Device)
+  RETURN p.name, COUNT(d) as device_count
+  ORDER BY device_count DESC
   LIMIT 1
-$$) AS (parcel_name agtype, device_count agtype);
+$$) as (name agtype, device_count agtype);


================================================================================
SUMMARY
================================================================================
Total queries compared: 9
Queries in ground truth: 9
Queries in LLM output: 9

Differences detected - see details above
